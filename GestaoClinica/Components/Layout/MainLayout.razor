@inherits LayoutComponentBase

<MudThemeProvider Theme="@_theme" IsDarkMode="_isDarkMode" />
<MudPopoverProvider />
<MudDialogProvider FullWidth="true" MaxWidth="MaxWidth.Medium" />
<MudSnackbarProvider />

<MudLayout>
    <MudAppBar Elevation="1" Style="background-color: #57A8A1;">
        <MudIconButton Icon="@Icons.Material.Filled.Menu"
                       Color="Color.Inherit"
                       Edge="Edge.Start"
                       OnClick="@DrawerToggle" />

        <MudText Typo="Typo.h6" Class="ml-3" Style="color: #FFFFFF;">
            <MudIcon Icon="@Icons.Material.Filled.LocalHospital" Size="Size.Small" Class="mr-2" />
            ClinicPro
        </MudText>

        <MudSpacer />

        <MudIconButton Icon="@(DarkLightModeButtonIcon)"
                       Color="Color.Inherit" Style="color: #FFFFFF;"
                       OnClick="@DarkModeToggle"
                       Title="Alternar modo claro/escuro" />

        <MudIconButton Icon="@Icons.Material.Filled.AccountCircle"
                       Color="Color.Inherit" Style="color: #FFFFFF;"
                       Edge="Edge.End"
                       Title="Perfil do usuário">
            <MudMenu AnchorOrigin="Origin.TopRight"
                     TransformOrigin="Origin.TopRight">
                <MudMenuItem>
                    <MudIcon Icon="@Icons.Material.Filled.Person" Class="mr-2" />
                    Meu Perfil
                </MudMenuItem>
                <MudMenuItem>
                    <MudIcon Icon="@Icons.Material.Filled.Settings" Class="mr-2" />
                    Configurações
                </MudMenuItem>
                <MudDivider />
                <MudMenuItem>
                    <MudIcon Icon="@Icons.Material.Filled.ExitToApp" Class="mr-2" Color="Color.Error" />
                    Sair
                </MudMenuItem>
            </MudMenu>
        </MudIconButton>
    </MudAppBar>

    <MudDrawer @bind-Open="_drawerOpen"
               ClipMode="DrawerClipMode.Always"
               Elevation="2"
               Width="260px">
        
        <NavMenu />
    </MudDrawer>

    <MudMainContent Class="pt-16 pa-4">
        @Body
    </MudMainContent>
</MudLayout>

@code {
    [Inject] private IJSRuntime JSRuntime { get; set; } = default!;

    private bool _isDarkMode = false; // Modo claro por padrão
    private MudTheme? _theme = null;
    private bool _drawerOpen = true; // Drawer aberto por padrão

    protected override void OnInitialized()
    {
        base.OnInitialized();

        _theme = new MudTheme
            {
                PaletteLight = new PaletteLight()
                {
                    Primary = "#57A8A1", // Verde principal
                    Secondary = "#ff4081",
                    Background = "#FFFFFF", // Fundo branco
                    AppbarBackground = "#57A8A1", // Barra superior verde
                    AppbarText = "#FFFFFF", // Texto branco
                    DrawerBackground = "#FFFFFF", // Drawer branco
                    DrawerText = "#424242", // Texto do drawer
                    Surface = "#FFFFFF", // Superfícies brancas
                },
                PaletteDark = new PaletteDark()
                {
                    Primary = "#57A8A1", // Mesmo verde no modo escuro
                },
                LayoutProperties = new LayoutProperties()
            };
    }

    private void DrawerToggle()
    {
        _drawerOpen = !_drawerOpen;
    }

    private void DarkModeToggle()
    {
        _isDarkMode = !_isDarkMode;
    }

    public string DarkLightModeButtonIcon => _isDarkMode switch
    {
        true => Icons.Material.Filled.LightMode,
        false => Icons.Material.Filled.DarkMode,
    };
}